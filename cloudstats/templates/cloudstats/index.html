{% extends 'base.html' %}
{% load humanize %}
{% load i18n %}

{% block title %}
{% translate "Your cloud use" %}
{% endblock title %}

{% block content %}
<h1>{% translate "Your cloud use" %}</h1>

<h3>{% translate "Your projects" %}</h3>
    {% if projects %}
    <ul>
    {% for project in projects %}
      <li><a href="{{ project }}">{{project}}</a></li>
    {% endfor %}
    </ul>
    {% else %}
    <p>{% translate "You have no projects" %}</p>
    {% endif %}

{% if request.META.is_staff %}
  <h3>{% translate "All projects" %}</h3>
  <h4>CPU used</h4>
  <div id="graph_cpu"></div>
  <h4>Memory used</h4>
  <div id="graph_mem"></div>
  <table class="table table-striped">
    <thead class="thead-dark">
      <tr>
        <th>{% translate "Project" %}</th>
        <th>{% translate "Allocated cores" %}</th>
      </tr>
    </thead>
    <tbody>
  {% for project in all_projects %}
    <tr>
      <td><a href="{{ project.name }}">{{project.name}}</a></td>
      <td>{{project.cores}}</td>
    </tr>
  {% endfor %}
    </tbody>
  </table>
{% endif %}

{% if request.META.is_staff %}
<script>
  loadGraph('graph_cpu', 'graph/cpu.json');
  loadGraph('graph_mem', 'graph/mem.json');
</script>
{% endif %}
{% endblock content %}
